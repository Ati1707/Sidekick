<div class="relative w-full h-3 overflow-hidden rounded-full bg-neutral-700">
    <span style="@($"width: {Value}%")" class="absolute w-24 h-full duration-300 ease-linear bg-purple-600" x-cloak></span>
</div>

@using System.Timers
@implements IDisposable

@code {

    [Parameter]
    public int Percent { get; set; }

    [Parameter]
    public bool Indeterminate { get; set; }

    private int Value { get; set; }

    private Timer? Timer { get; set; }

    protected override void OnParametersSet()
    {
        Value = Percent;

        if (Indeterminate)
        {
            Timer = new Timer(100);
            Timer.Elapsed+= TimerOnElapsed;
        }

        base.OnParametersSet();
    }

    private void TimerOnElapsed(
        object? sender,
        ElapsedEventArgs e)
    {
        Value += 5;
        if (Value > 100)
        {
            Value = 0;
        }

        StateHasChanged();
    }

    public void Dispose()
    {
        if (Timer == null) return;
        Timer.Elapsed -= TimerOnElapsed;
        Timer.Dispose();
    }

}
